<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="StatisticDAO">


	<select id="getMonthlyReport" resultType="java.util.HashMap">
	/* StatisticDAO.getMonthlyReport 월별 접속자 통계 */
		SELECT	SUBSTRING(OCCRRNC_DE,5,2) AS OMONTH
				, SUM(USER_CO) AS OCNT
		FROM 	COMTSUSERSUMMARY 
		WHERE LEFT(OCCRRNC_DE, 4) = DATE_FORMAT(CURDATE(),'%Y')
		GROUP BY OMONTH
	</select>
	
	<select id="getRcntBbsList" resultType="java.util.HashMap">
	/* StatisticDAO.getRcntBbsList 최근 등록된 게시물 10건 가져오기 */
		SELECT 	BBS_ID, 
			 	NTT_SJ,
			 	DATE_FORMAT(FRST_REGIST_PNTTM, '%Y-%m-%d') AS FRST_REGIST_PNTTM,
			 	NTCR_ID
		FROM 	COMTNBBS  
		ORDER BY FRST_REGIST_PNTTM DESC LIMIT 10 
	</select>
	
	<select id="getpopulMenuList" resultType="java.util.HashMap">
	/* StatisticDAO.getpopulMenuList 인기 메뉴 5건 가져오기 */
		SELECT 	T1.URL
				, T1.RDCNT
				, T2.PROGRM_STRE_PATH
				, T2.PROGRM_KOREAN_NM
		FROM	COMTSWEBLOGSUMMARY T1 INNER JOIN COMTNPROGRMLIST T2 ON T1.URL = T2.URL
		WHERE 	T2.PROGRM_FILE_NM like 'phcf%'
		ORDER BY T1.RDCNT DESC
		LIMIT 	5
	</select>
	
	<select id="getConnectCnt" resultType="String">
	/* StatisticDAO.getConnectCnt 오늘 접속자 수 가져오기 */
		SELECT	COUNT(CONECT_MTHD) 
		 FROM 	COMTNLOGINLOG 
		WHERE	DATE_FORMAT(CREAT_DT, '%Y-%m-%d') = CURDATE() 
		  AND 	CONECT_MTHD = 'I'; 
	</select>


</mapper>